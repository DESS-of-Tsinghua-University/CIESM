#include "dtypes.h"
!===================================================
! DO NOT EDIT THIS FILE, it was generated using /home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/tools/cprnc/genf90/genf90.pl 
! Any changes you make to this file may be lost
!===================================================
!>>>>>>>>>>>>>>>>>>>>wwj
#define CFIO_PIO_LOG "cfio_pio_log"
!<<<<<<<<<<<<<<<<<<<<<<<<
#define __PIO_FILE__ "pionfput_mod.F90"
!>
!! @file 
!! $Revision: 788 $
!! $LastChangedDate: 2013-05-09 02:52:45 +0800 (Thu, 09 May 2013) $
!! @brief Write Routines for non-decomposed NetCDF data.
!<
module pionfput_mod
#ifdef TIMING
  use perf_mod, only : t_startf, t_stopf      ! _EXTERNAL
#endif
  use pio_kinds, only: i4,r4,r8,pio_offset
  use pio_types, only : file_desc_t, iosystem_desc_t, var_desc_t, &
	pio_iotype_pbinary, pio_iotype_binary, pio_iotype_direct_pbinary, &
	pio_iotype_netcdf, pio_iotype_pnetcdf, pio_iotype_netcdf4p, pio_iotype_netcdf4c, &
	pio_noerr
!>>>>>>>>>>>>>>>>>>>wwj
  use pio_types, only : pio_iotype_cfio
!<<<<<<<<<<<<<<<<<<<

  use pio_utils, only : check_netcdf
  use pio_msg_mod
  use pio_support, only : Debug, DebugIO, piodie   
#ifdef _NETCDF
  use netcdf            ! _EXTERNAL
#endif
#ifndef NO_MPIMOD
  use mpi   ! _EXTERNAL
#endif
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
use cfio
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
  implicit none
  private
#ifdef _PNETCDF
#include <pnetcdf.inc>  /* _EXTERNAL */
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
#include <pnetcdf.inc>  /* _EXTERNAL */
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
! Required for netcdf bug workaround
  integer, external :: nf_put_vars_text
#endif
#ifdef NO_MPIMOD
  include 'mpif.h'   ! _EXTERNAL
#endif
!>
!! @defgroup PIO_put_var PIO_put_var
!! @brief Writes netcdf metadata to a file
!! @details The put_var interface is provided as a simplified interface to
!!  write variables to a netcdf format file.   
!! @warning Although this is a collective call the variable is written from the 
!!  root IO task, no consistancy check is made with data passed on other tasks.
!! 
!<
  public :: put_var
# 67 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  interface put_var
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_0d_text, put_var_vdesc_0d_text
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_1d_text, put_var_vdesc_1d_text
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_2d_text, put_var_vdesc_2d_text
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_3d_text, put_var_vdesc_3d_text
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_4d_text, put_var_vdesc_4d_text
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_5d_text, put_var_vdesc_5d_text
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_0d_real, put_var_vdesc_0d_real
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_1d_real, put_var_vdesc_1d_real
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_2d_real, put_var_vdesc_2d_real
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_3d_real, put_var_vdesc_3d_real
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_4d_real, put_var_vdesc_4d_real
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_5d_real, put_var_vdesc_5d_real
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_0d_double, put_var_vdesc_0d_double
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_1d_double, put_var_vdesc_1d_double
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_2d_double, put_var_vdesc_2d_double
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_3d_double, put_var_vdesc_3d_double
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_4d_double, put_var_vdesc_4d_double
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_5d_double, put_var_vdesc_5d_double
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_0d_int, put_var_vdesc_0d_int
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_1d_int, put_var_vdesc_1d_int
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_2d_int, put_var_vdesc_2d_int
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_3d_int, put_var_vdesc_3d_int
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_4d_int, put_var_vdesc_4d_int
     !  DIMS 0,1,2,3,4,5
     module procedure put_var_5d_int, put_var_vdesc_5d_int
     !  DIMS 1,2,3,4,5
     module procedure put_vara_1d_text, put_vara_vdesc_1d_text
     !  DIMS 1,2,3,4,5
     module procedure put_vara_2d_text, put_vara_vdesc_2d_text
     !  DIMS 1,2,3,4,5
     module procedure put_vara_3d_text, put_vara_vdesc_3d_text
     !  DIMS 1,2,3,4,5
     module procedure put_vara_4d_text, put_vara_vdesc_4d_text
     !  DIMS 1,2,3,4,5
     module procedure put_vara_5d_text, put_vara_vdesc_5d_text
     !  DIMS 1,2,3,4,5
     module procedure put_vara_1d_real, put_vara_vdesc_1d_real
     !  DIMS 1,2,3,4,5
     module procedure put_vara_2d_real, put_vara_vdesc_2d_real
     !  DIMS 1,2,3,4,5
     module procedure put_vara_3d_real, put_vara_vdesc_3d_real
     !  DIMS 1,2,3,4,5
     module procedure put_vara_4d_real, put_vara_vdesc_4d_real
     !  DIMS 1,2,3,4,5
     module procedure put_vara_5d_real, put_vara_vdesc_5d_real
     !  DIMS 1,2,3,4,5
     module procedure put_vara_1d_double, put_vara_vdesc_1d_double
     !  DIMS 1,2,3,4,5
     module procedure put_vara_2d_double, put_vara_vdesc_2d_double
     !  DIMS 1,2,3,4,5
     module procedure put_vara_3d_double, put_vara_vdesc_3d_double
     !  DIMS 1,2,3,4,5
     module procedure put_vara_4d_double, put_vara_vdesc_4d_double
     !  DIMS 1,2,3,4,5
     module procedure put_vara_5d_double, put_vara_vdesc_5d_double
     !  DIMS 1,2,3,4,5
     module procedure put_vara_1d_int, put_vara_vdesc_1d_int
     !  DIMS 1,2,3,4,5
     module procedure put_vara_2d_int, put_vara_vdesc_2d_int
     !  DIMS 1,2,3,4,5
     module procedure put_vara_3d_int, put_vara_vdesc_3d_int
     !  DIMS 1,2,3,4,5
     module procedure put_vara_4d_int, put_vara_vdesc_4d_int
     !  DIMS 1,2,3,4,5
     module procedure put_vara_5d_int, put_vara_vdesc_5d_int
     module procedure put_var1_text, put_var1_vdesc_text
     module procedure put_var1_real, put_var1_vdesc_real
     module procedure put_var1_double, put_var1_vdesc_double
     module procedure put_var1_int, put_var1_vdesc_int
  end interface
# 74 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
contains

!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param index : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 87 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_text (File,varid, index, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, index(:)
    character(len=*), intent(in) :: ival
    integer, allocatable :: count(:)
    integer :: iotype
    type(iosystem_desc_t), pointer :: ios
    integer :: xlen, msg, mpierr, isize, itype
    integer(4) :: ndims

#ifdef TIMING
    call t_startf("pio_put_var1_text")
#endif 
    ierr=PIO_NOERR
    iotype = File%iotype 
    if(debug) print *,__PIO_FILE__,__LINE__,ival,iotype, index

    ios=>File%iosystem

    xlen = len_trim(ival)
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR1
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       isize = size(index)
       call MPI_BCAST(isize,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(index,isize,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface) then
       call MPI_BCAST(ival,xlen,MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    if(Ios%IOProc) then
       allocate(count(size(index)))
       if(Ios%io_rank == 0) then
          count(:) = 1
          count(1) = len(ival)
       else
          count(:) = 0
       end if

       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), &
                  int(count,kind=PIO_OFFSET), ival, int(count,kind=PIO_OFFSET), &
                  MPI_CHARACTER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
             ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), &
                  int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_CHARACTER)
#endif

#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data - not defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data &
             over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara - not defined"
          endif
#endif
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), &
                  int(count,kind=PIO_OFFSET), ival, int(count,kind=PIO_OFFSET), &
                  MPI_CHARACTER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not &
             defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_all not&
             defined"
          endif
#endif
         !    ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), &
         !         int(count,kind=PIO_OFFSET), &
         !         ival, int(count,kind=PIO_OFFSET), MPI_CHARACTER)
         !   ndims = 1
         !    ierr = cfio_put_vara_text (File%fh, varid, ndims, int(index),int(count), ival) 
         ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_all over",ierr
          endif
#endif
#endif


#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case (pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=index)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=index)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(count)
    end if
    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_var1_text")
#endif 
  end function put_var1_text
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param index : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 282 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_int (File,varid, index, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, index(:)
    integer(i4), intent(in) :: ival
    integer, allocatable :: count(:)
    integer :: iotype, isize
    type(iosystem_desc_t), pointer :: ios
    integer :: xlen, msg, mpierr, itype
    integer(4) :: ndims

#ifdef TIMING
    call t_startf("pio_put_var1_int")
#endif 
    ierr=PIO_NOERR
    iotype = File%iotype 
    if(debug) print *,__PIO_FILE__,__LINE__,ival,iotype, index

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR1
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       isize = size(index)
       call MPI_BCAST(isize,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(index,isize,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface) then
       call MPI_BCAST(ival,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    if(Ios%IOProc) then
       allocate(count(size(index)))
       if(Ios%io_rank == 0) then
          count(:) = 1
       else
          count(:) = 0
       end if

       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_INTEGER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
               ival, int(count,kind=PIO_OFFSET), MPI_INTEGER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara not defined"
          endif
#endif
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_INTEGER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_all not defined"
          endif
#endif
        !  ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
        !       ival, int(count,kind=PIO_OFFSET), MPI_INTEGER)
       ! ndims = 1
       !   ierr = cfio_put_vara_int (File%fh, varid, ndims, int(index), int(count),ival)
       ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_all over",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case (pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=index)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=index)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(count)
    end if
    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_var1_int")
#endif 
  end function put_var1_int
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param index : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 282 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_real (File,varid, index, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, index(:)
    real(r4), intent(in) :: ival
    integer, allocatable :: count(:)
    integer :: iotype, isize
    type(iosystem_desc_t), pointer :: ios
    integer :: xlen, msg, mpierr, itype
    integer(4) :: ndims

#ifdef TIMING
    call t_startf("pio_put_var1_real")
#endif 
    ierr=PIO_NOERR
    iotype = File%iotype 
    if(debug) print *,__PIO_FILE__,__LINE__,ival,iotype, index

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR1
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       isize = size(index)
       call MPI_BCAST(isize,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(index,isize,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface) then
       call MPI_BCAST(ival,1,MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if



    if(Ios%IOProc) then
       allocate(count(size(index)))
       if(Ios%io_rank == 0) then
          count(:) = 1
       else
          count(:) = 0
       end if

       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_REAL4)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
               ival, int(count,kind=PIO_OFFSET), MPI_REAL4)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara not defined"
          endif
#endif
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_REAL4)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_all not defined"
          endif
#endif
        !  ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
        !       ival, int(count,kind=PIO_OFFSET), MPI_REAL4)
       ! ndims = 1
       !   ierr = cfio_put_vara_real (File%fh, varid, ndims, int(index), int(count),ival)
       ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_all over",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case (pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=index)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=index)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(count)
    end if
    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_var1_real")
#endif 
  end function put_var1_real
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param index : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 282 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_double (File,varid, index, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, index(:)
    real(r8), intent(in) :: ival
    integer, allocatable :: count(:)
    integer :: iotype, isize
    type(iosystem_desc_t), pointer :: ios
    integer :: xlen, msg, mpierr, itype
    integer(4) :: ndims

#ifdef TIMING
    call t_startf("pio_put_var1_double")
#endif 
    ierr=PIO_NOERR
    iotype = File%iotype 
    if(debug) print *,__PIO_FILE__,__LINE__,ival,iotype, index

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR1
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       isize = size(index)
       call MPI_BCAST(isize,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(index,isize,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface) then
       call MPI_BCAST(ival,1,MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if



    if(Ios%IOProc) then
       allocate(count(size(index)))
       if(Ios%io_rank == 0) then
          count(:) = 1
       else
          count(:) = 0
       end if

       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_REAL8)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
               ival, int(count,kind=PIO_OFFSET), MPI_REAL8)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara not defined"
          endif
#endif
             ierr = nfmpi_put_vara (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
                  ival, int(count,kind=PIO_OFFSET), MPI_REAL8)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_all not defined"
          endif
#endif
        !  ierr = nfmpi_put_vara_all (File%fh, varid, int(index,kind=PIO_OFFSET), int(count,kind=PIO_OFFSET), &
        !       ival, int(count,kind=PIO_OFFSET), MPI_REAL8)
       ! ndims = 1
       !   ierr = cfio_put_vara_double (File%fh, varid, ndims, int(index), int(count),ival)
       ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_all over",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case (pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=index)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=index)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(count)
    end if
    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_var1_double")
#endif 
  end function put_var1_double

!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 468 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_vdesc_text (File,vardesc, start, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:)
    character(len=*), intent(in) :: ival

    ierr = put_var1_text (File, vardesc%varid, start, ival)
  end function put_var1_vdesc_text

!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 468 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_vdesc_real (File,vardesc, start, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:)
    real(r4), intent(in) :: ival

    ierr = put_var1_real (File, vardesc%varid, start, ival)
  end function put_var1_vdesc_real

!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 468 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_vdesc_double (File,vardesc, start, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:)
    real(r8), intent(in) :: ival

    ierr = put_var1_double (File, vardesc%varid, start, ival)
  end function put_var1_vdesc_double

!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 468 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var1_vdesc_int (File,vardesc, start, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:)
    integer(i4), intent(in) :: ival

    ierr = put_var1_int (File, vardesc%varid, start, ival)
  end function put_var1_vdesc_int

! DIMS 0,1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 490 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_0d_text (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    character(len=*), intent(in) :: ival
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen, itype
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(0)
    integer :: start(0+1), count(0+1)
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
    character, allocatable :: ival_to_arr(:)
    integer :: len_total, pos, d0, d1, d2, d3, d4, d5
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
#ifdef TIMING
    call t_startf("pio_put_var_0d_text")
#endif 
    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       


    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_0d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (0 > 0)
       do i=1,0
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,0,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       xlen = len(ival)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
#if(0==0)       
       call MPI_BCAST(ival,len_trim(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#else
       call MPI_BCAST(ival,size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
    	  count(1)=len(ival)
	  is=1
#if (0 > 0)
          do i=1,0
             count(i+is) = size(ival,i)
          end do
#endif
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(ios%io_rank>0) count = 0
          ierr = nfmpi_put_vara_text_all (File%fh, varid,int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

          if (0 == Ios%io_rank) then
             !!! allocate memory
             len_total = count(1)
             do i = 1, 0
                len_total = len_total * count(i+1)
             end do
             allocate(ival_to_arr(len_total))

             !!! copy ival to ival_to_arr
             pos = 1
#if (0 == 0)       
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d0:d0)
                 pos = pos + 1
             end do
#elif (1 == 0)       
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1)(d0:d0)
                 pos = pos + 1
             end do
             end do
#elif (2 == 0)       
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
#elif (3 == 0)       
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
#elif (4 == 0)       
             else if (4 == 0) then
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
#elif (5 == 0)       
             do d5 = 1, count(6)
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4, d5)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
             end do
#endif
          else !!! io_rank > 0
             count = 0
          end if
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_text_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text ..."
             print *, "[CFIO DEBUG]: 0", len(ival)
          endif
#endif

          ierr = cfio_put_vara_text (File%fh, varid, 0+1, int(start), int(count), ival_to_arr)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text over ",ierr
          endif
#endif

          if(0 == Ios%io_rank) then
             deallocate(ival_to_arr)
          end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
#if (0==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 668 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
          if (Ios%io_rank == 0) then
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
          else
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/0/), (/1/), ival)
          end if
#else
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
#endif
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then

#if (0==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 685 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
#else
             ierr = nf90_put_var(File%fh, varid, ival)
#endif
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_0d_text")
#endif 
  end function put_var_0d_text

! DIMS 0,1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 490 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_1d_text (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    character(len=*), intent(in) :: ival(:)
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen, itype
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1)
    integer :: start(1+1), count(1+1)
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
    character, allocatable :: ival_to_arr(:)
    integer :: len_total, pos, d0, d1, d2, d3, d4, d5
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
#ifdef TIMING
    call t_startf("pio_put_var_1d_text")
#endif 
    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       


    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (1 > 0)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       xlen = len(ival)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
#if(1==0)       
       call MPI_BCAST(ival,len_trim(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#else
       call MPI_BCAST(ival,size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
    	  count(1)=len(ival)
	  is=1
#if (1 > 0)
          do i=1,1
             count(i+is) = size(ival,i)
          end do
#endif
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(ios%io_rank>0) count = 0
          ierr = nfmpi_put_vara_text_all (File%fh, varid,int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

          if (0 == Ios%io_rank) then
             !!! allocate memory
             len_total = count(1)
             do i = 1, 1
                len_total = len_total * count(i+1)
             end do
             allocate(ival_to_arr(len_total))

             !!! copy ival to ival_to_arr
             pos = 1
#if (0 == 1)       
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d0:d0)
                 pos = pos + 1
             end do
#elif (1 == 1)       
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1)(d0:d0)
                 pos = pos + 1
             end do
             end do
#elif (2 == 1)       
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
#elif (3 == 1)       
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
#elif (4 == 1)       
             else if (4 == 1) then
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
#elif (5 == 1)       
             do d5 = 1, count(6)
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4, d5)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
             end do
#endif
          else !!! io_rank > 0
             count = 0
          end if
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_text_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text ..."
             print *, "[CFIO DEBUG]: 1", len(ival)
          endif
#endif

          ierr = cfio_put_vara_text (File%fh, varid, 1+1, int(start), int(count), ival_to_arr)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text over ",ierr
          endif
#endif

          if(0 == Ios%io_rank) then
             deallocate(ival_to_arr)
          end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
#if (1==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 668 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
          if (Ios%io_rank == 0) then
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
          else
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/0/), (/1/), ival)
          end if
#else
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
#endif
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then

#if (1==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 685 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
#else
             ierr = nf90_put_var(File%fh, varid, ival)
#endif
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_1d_text")
#endif 
  end function put_var_1d_text

! DIMS 0,1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 490 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_2d_text (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    character(len=*), intent(in) :: ival(:,:)
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen, itype
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2)
    integer :: start(2+1), count(2+1)
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
    character, allocatable :: ival_to_arr(:)
    integer :: len_total, pos, d0, d1, d2, d3, d4, d5
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
#ifdef TIMING
    call t_startf("pio_put_var_2d_text")
#endif 
    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       


    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (2 > 0)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       xlen = len(ival)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
#if(2==0)       
       call MPI_BCAST(ival,len_trim(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#else
       call MPI_BCAST(ival,size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
    	  count(1)=len(ival)
	  is=1
#if (2 > 0)
          do i=1,2
             count(i+is) = size(ival,i)
          end do
#endif
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(ios%io_rank>0) count = 0
          ierr = nfmpi_put_vara_text_all (File%fh, varid,int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

          if (0 == Ios%io_rank) then
             !!! allocate memory
             len_total = count(1)
             do i = 1, 2
                len_total = len_total * count(i+1)
             end do
             allocate(ival_to_arr(len_total))

             !!! copy ival to ival_to_arr
             pos = 1
#if (0 == 2)       
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d0:d0)
                 pos = pos + 1
             end do
#elif (1 == 2)       
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1)(d0:d0)
                 pos = pos + 1
             end do
             end do
#elif (2 == 2)       
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
#elif (3 == 2)       
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
#elif (4 == 2)       
             else if (4 == 2) then
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
#elif (5 == 2)       
             do d5 = 1, count(6)
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4, d5)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
             end do
#endif
          else !!! io_rank > 0
             count = 0
          end if
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_text_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text ..."
             print *, "[CFIO DEBUG]: 2", len(ival)
          endif
#endif

          ierr = cfio_put_vara_text (File%fh, varid, 2+1, int(start), int(count), ival_to_arr)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text over ",ierr
          endif
#endif

          if(0 == Ios%io_rank) then
             deallocate(ival_to_arr)
          end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
#if (2==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 668 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
          if (Ios%io_rank == 0) then
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
          else
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/0/), (/1/), ival)
          end if
#else
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
#endif
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then

#if (2==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 685 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
#else
             ierr = nf90_put_var(File%fh, varid, ival)
#endif
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_2d_text")
#endif 
  end function put_var_2d_text

! DIMS 0,1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 490 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_3d_text (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    character(len=*), intent(in) :: ival(:,:,:)
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen, itype
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3)
    integer :: start(3+1), count(3+1)
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
    character, allocatable :: ival_to_arr(:)
    integer :: len_total, pos, d0, d1, d2, d3, d4, d5
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
#ifdef TIMING
    call t_startf("pio_put_var_3d_text")
#endif 
    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       


    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (3 > 0)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       xlen = len(ival)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
#if(3==0)       
       call MPI_BCAST(ival,len_trim(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#else
       call MPI_BCAST(ival,size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
    	  count(1)=len(ival)
	  is=1
#if (3 > 0)
          do i=1,3
             count(i+is) = size(ival,i)
          end do
#endif
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(ios%io_rank>0) count = 0
          ierr = nfmpi_put_vara_text_all (File%fh, varid,int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

          if (0 == Ios%io_rank) then
             !!! allocate memory
             len_total = count(1)
             do i = 1, 3
                len_total = len_total * count(i+1)
             end do
             allocate(ival_to_arr(len_total))

             !!! copy ival to ival_to_arr
             pos = 1
#if (0 == 3)       
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d0:d0)
                 pos = pos + 1
             end do
#elif (1 == 3)       
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1)(d0:d0)
                 pos = pos + 1
             end do
             end do
#elif (2 == 3)       
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
#elif (3 == 3)       
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
#elif (4 == 3)       
             else if (4 == 3) then
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
#elif (5 == 3)       
             do d5 = 1, count(6)
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4, d5)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
             end do
#endif
          else !!! io_rank > 0
             count = 0
          end if
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_text_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text ..."
             print *, "[CFIO DEBUG]: 3", len(ival)
          endif
#endif

          ierr = cfio_put_vara_text (File%fh, varid, 3+1, int(start), int(count), ival_to_arr)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text over ",ierr
          endif
#endif

          if(0 == Ios%io_rank) then
             deallocate(ival_to_arr)
          end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
#if (3==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 668 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
          if (Ios%io_rank == 0) then
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
          else
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/0/), (/1/), ival)
          end if
#else
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
#endif
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then

#if (3==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 685 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
#else
             ierr = nf90_put_var(File%fh, varid, ival)
#endif
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_3d_text")
#endif 
  end function put_var_3d_text

! DIMS 0,1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 490 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_4d_text (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    character(len=*), intent(in) :: ival(:,:,:,:)
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen, itype
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4)
    integer :: start(4+1), count(4+1)
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
    character, allocatable :: ival_to_arr(:)
    integer :: len_total, pos, d0, d1, d2, d3, d4, d5
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
#ifdef TIMING
    call t_startf("pio_put_var_4d_text")
#endif 
    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       


    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (4 > 0)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       xlen = len(ival)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
#if(4==0)       
       call MPI_BCAST(ival,len_trim(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#else
       call MPI_BCAST(ival,size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
    	  count(1)=len(ival)
	  is=1
#if (4 > 0)
          do i=1,4
             count(i+is) = size(ival,i)
          end do
#endif
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(ios%io_rank>0) count = 0
          ierr = nfmpi_put_vara_text_all (File%fh, varid,int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

          if (0 == Ios%io_rank) then
             !!! allocate memory
             len_total = count(1)
             do i = 1, 4
                len_total = len_total * count(i+1)
             end do
             allocate(ival_to_arr(len_total))

             !!! copy ival to ival_to_arr
             pos = 1
#if (0 == 4)       
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d0:d0)
                 pos = pos + 1
             end do
#elif (1 == 4)       
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1)(d0:d0)
                 pos = pos + 1
             end do
             end do
#elif (2 == 4)       
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
#elif (3 == 4)       
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
#elif (4 == 4)       
             else if (4 == 4) then
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
#elif (5 == 4)       
             do d5 = 1, count(6)
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4, d5)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
             end do
#endif
          else !!! io_rank > 0
             count = 0
          end if
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_text_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text ..."
             print *, "[CFIO DEBUG]: 4", len(ival)
          endif
#endif

          ierr = cfio_put_vara_text (File%fh, varid, 4+1, int(start), int(count), ival_to_arr)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text over ",ierr
          endif
#endif

          if(0 == Ios%io_rank) then
             deallocate(ival_to_arr)
          end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
#if (4==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 668 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
          if (Ios%io_rank == 0) then
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
          else
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/0/), (/1/), ival)
          end if
#else
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
#endif
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then

#if (4==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 685 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
#else
             ierr = nf90_put_var(File%fh, varid, ival)
#endif
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_4d_text")
#endif 
  end function put_var_4d_text

! DIMS 0,1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 490 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_5d_text (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    character(len=*), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen, itype
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5)
    integer :: start(5+1), count(5+1)
!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
    character, allocatable :: ival_to_arr(:)
    integer :: len_total, pos, d0, d1, d2, d3, d4, d5
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
#ifdef TIMING
    call t_startf("pio_put_var_5d_text")
#endif 
    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       


    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (5 > 0)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       xlen = len(ival)
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
#if(5==0)       
       call MPI_BCAST(ival,len_trim(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#else
       call MPI_BCAST(ival,size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
    	  count(1)=len(ival)
	  is=1
#if (5 > 0)
          do i=1,5
             count(i+is) = size(ival,i)
          end do
#endif
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(ios%io_rank>0) count = 0
          ierr = nfmpi_put_vara_text_all (File%fh, varid,int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

          if (0 == Ios%io_rank) then
             !!! allocate memory
             len_total = count(1)
             do i = 1, 5
                len_total = len_total * count(i+1)
             end do
             allocate(ival_to_arr(len_total))

             !!! copy ival to ival_to_arr
             pos = 1
#if (0 == 5)       
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d0:d0)
                 pos = pos + 1
             end do
#elif (1 == 5)       
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1)(d0:d0)
                 pos = pos + 1
             end do
             end do
#elif (2 == 5)       
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
#elif (3 == 5)       
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
#elif (4 == 5)       
             else if (4 == 5) then
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
#elif (5 == 5)       
             do d5 = 1, count(6)
             do d4 = 1, count(5)
             do d3 = 1, count(4)
             do d2 = 1, count(3)
             do d1 = 1, count(2)
             do d0 = 1, count(1)
                 ival_to_arr(pos) = ival(d1, d2, d3, d4, d5)(d0:d0)
                 pos = pos + 1
             end do
             end do
             end do
             end do
             end do
             end do
#endif
          else !!! io_rank > 0
             count = 0
          end if
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_text_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text ..."
             print *, "[CFIO DEBUG]: 5", len(ival)
          endif
#endif

          ierr = cfio_put_vara_text (File%fh, varid, 5+1, int(start), int(count), ival_to_arr)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text over ",ierr
          endif
#endif

          if(0 == Ios%io_rank) then
             deallocate(ival_to_arr)
          end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
#if (5==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 668 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
          if (Ios%io_rank == 0) then
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
          else
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/0/), (/1/), ival)
          end if
#else
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
#endif
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then

#if (5==0)
! This is a workaround for a bug in the netcdf f90 interface
! The netcdf bug is that when you use nf90_put_var
! to write a scalar string the trailing blanks are stripped by the specific
# 685 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
! function nf90_put_var_text before it calls nf_put_vars_text. 
             ierr = nf_put_vars_text(File%fh, varid, (/1/), (/len(ival)/), (/1/), ival)
#else
             ierr = nf90_put_var(File%fh, varid, ival)
#endif
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_5d_text")
#endif 
  end function put_var_5d_text

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_1d_int (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    integer(i4), intent(in) :: ival(:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1)
    integer :: start(1), count(1)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,1
          count(i) = size(ival,i)
       end do
       ierr = put_vara_1d_int (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,1
          count(i) = size(ival,i)
       end do
       ierr = put_vara_1d_int (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_1d_int")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,1
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_int_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 1
          !ierr = cfio_put_vara_int(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_1d_int")
#endif 
  end function put_var_1d_int

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_2d_int (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    integer(i4), intent(in) :: ival(:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2)
    integer :: start(2), count(2)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,2
          count(i) = size(ival,i)
       end do
       ierr = put_vara_2d_int (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,2
          count(i) = size(ival,i)
       end do
       ierr = put_vara_2d_int (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_2d_int")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,2
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_int_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 2
          !ierr = cfio_put_vara_int(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_2d_int")
#endif 
  end function put_var_2d_int

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_3d_int (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    integer(i4), intent(in) :: ival(:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3)
    integer :: start(3), count(3)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,3
          count(i) = size(ival,i)
       end do
       ierr = put_vara_3d_int (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,3
          count(i) = size(ival,i)
       end do
       ierr = put_vara_3d_int (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_3d_int")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,3
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_int_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 3
          !ierr = cfio_put_vara_int(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_3d_int")
#endif 
  end function put_var_3d_int

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_4d_int (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    integer(i4), intent(in) :: ival(:,:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4)
    integer :: start(4), count(4)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,4
          count(i) = size(ival,i)
       end do
       ierr = put_vara_4d_int (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,4
          count(i) = size(ival,i)
       end do
       ierr = put_vara_4d_int (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_4d_int")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,4
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_int_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 4
          !ierr = cfio_put_vara_int(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_4d_int")
#endif 
  end function put_var_4d_int

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_5d_int (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    integer(i4), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5)
    integer :: start(5), count(5)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,5
          count(i) = size(ival,i)
       end do
       ierr = put_vara_5d_int (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,5
          count(i) = size(ival,i)
       end do
       ierr = put_vara_5d_int (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_5d_int")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,5
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_int_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 5
          !ierr = cfio_put_vara_int(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_5d_int")
#endif 
  end function put_var_5d_int

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_1d_real (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r4), intent(in) :: ival(:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1)
    integer :: start(1), count(1)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,1
          count(i) = size(ival,i)
       end do
       ierr = put_vara_1d_real (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,1
          count(i) = size(ival,i)
       end do
       ierr = put_vara_1d_real (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_1d_real")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,1
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_real_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 1
          !ierr = cfio_put_vara_real(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_1d_real")
#endif 
  end function put_var_1d_real

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_2d_real (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r4), intent(in) :: ival(:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2)
    integer :: start(2), count(2)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,2
          count(i) = size(ival,i)
       end do
       ierr = put_vara_2d_real (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,2
          count(i) = size(ival,i)
       end do
       ierr = put_vara_2d_real (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_2d_real")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,2
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_real_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 2
          !ierr = cfio_put_vara_real(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_2d_real")
#endif 
  end function put_var_2d_real

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_3d_real (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r4), intent(in) :: ival(:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3)
    integer :: start(3), count(3)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,3
          count(i) = size(ival,i)
       end do
       ierr = put_vara_3d_real (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,3
          count(i) = size(ival,i)
       end do
       ierr = put_vara_3d_real (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_3d_real")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,3
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_real_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 3
          !ierr = cfio_put_vara_real(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_3d_real")
#endif 
  end function put_var_3d_real

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_4d_real (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r4), intent(in) :: ival(:,:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4)
    integer :: start(4), count(4)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,4
          count(i) = size(ival,i)
       end do
       ierr = put_vara_4d_real (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,4
          count(i) = size(ival,i)
       end do
       ierr = put_vara_4d_real (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_4d_real")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,4
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_real_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 4
          !ierr = cfio_put_vara_real(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_4d_real")
#endif 
  end function put_var_4d_real

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_5d_real (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r4), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5)
    integer :: start(5), count(5)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,5
          count(i) = size(ival,i)
       end do
       ierr = put_vara_5d_real (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,5
          count(i) = size(ival,i)
       end do
       ierr = put_vara_5d_real (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_5d_real")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,5
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_real_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 5
          !ierr = cfio_put_vara_real(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_5d_real")
#endif 
  end function put_var_5d_real

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_1d_double (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r8), intent(in) :: ival(:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1)
    integer :: start(1), count(1)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,1
          count(i) = size(ival,i)
       end do
       ierr = put_vara_1d_double (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,1
          count(i) = size(ival,i)
       end do
       ierr = put_vara_1d_double (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_1d_double")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,1
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_double_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 1
          !ierr = cfio_put_vara_double(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_1d_double")
#endif 
  end function put_var_1d_double

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_2d_double (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r8), intent(in) :: ival(:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2)
    integer :: start(2), count(2)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,2
          count(i) = size(ival,i)
       end do
       ierr = put_vara_2d_double (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,2
          count(i) = size(ival,i)
       end do
       ierr = put_vara_2d_double (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_2d_double")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,2
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_double_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 2
          !ierr = cfio_put_vara_double(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_2d_double")
#endif 
  end function put_var_2d_double

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_3d_double (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r8), intent(in) :: ival(:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3)
    integer :: start(3), count(3)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,3
          count(i) = size(ival,i)
       end do
       ierr = put_vara_3d_double (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,3
          count(i) = size(ival,i)
       end do
       ierr = put_vara_3d_double (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_3d_double")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,3
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_double_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 3
          !ierr = cfio_put_vara_double(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_3d_double")
#endif 
  end function put_var_3d_double

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_4d_double (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r8), intent(in) :: ival(:,:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4)
    integer :: start(4), count(4)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,4
          count(i) = size(ival,i)
       end do
       ierr = put_vara_4d_double (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,4
          count(i) = size(ival,i)
       end do
       ierr = put_vara_4d_double (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_4d_double")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,4
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_double_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 4
          !ierr = cfio_put_vara_double(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_4d_double")
#endif 
  end function put_var_4d_double

! DIMS 1,2,3,4,5
! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 718 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_5d_double (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r8), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, itype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5)
    integer :: start(5), count(5)
    integer(4) :: ndims



    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 0
    is=0       

#ifdef _PNETCDF
    if(iotype == pio_iotype_pnetcdf) then
       do i=1,5
          count(i) = size(ival,i)
       end do
       ierr = put_vara_5d_double (File, varid, start, count, ival)
       return
    end if
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    if(iotype == pio_iotype_cfio) then
       do i=1,5
          count(i) = size(ival,i)
       end do
       ierr = put_vara_5d_double (File, varid, start, count, ival)
       return
    end if
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef TIMING
    call t_startf("pio_put_var_5d_double")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       if(Ios%io_rank==0) then
          do i=1,5
             count(i+is) = size(ival,i)
          end do
       end if
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_double_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double_all not defined"
          endif
#endif
          !ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
          ndims = 5
          !ierr = cfio_put_vara_double(File%fh, varid, ndims, int(start),int(count), ival)
          ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double_all over",ierr
          endif
#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=start, count=count)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_5d_double")
#endif 
  end function put_var_5d_double

! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 858 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_0d_int (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    integer(i4), intent(in) :: ival
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: start(1),count(1), itype
    integer(4) :: ndims

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    integer(i4) :: ival_to_arr(1)
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 1
    is=0       

#ifdef TIMING
    call t_startf("pio_put_var_0d_int")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_0d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_int_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int ... "
          endif
#endif
          !!! PnetCDF
          !ierr = nfmpi_put_vara_int_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
         ! ndims = 1
         ! ierr = cfio_put_vara_int(File%fh, varid, ndims,int(start),int(count), ival)

          !!! CFIO
          ival_to_arr(1) = ival
          ierr = cfio_put_vara_int(File%fh, varid, 0, start, count, ival_to_arr)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int over ", ierr
          endif
#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_0d_int")
#endif 
  end function put_var_0d_int

! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 858 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_0d_real (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r4), intent(in) :: ival
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: start(1),count(1), itype
    integer(4) :: ndims

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    real(r4) :: ival_to_arr(1)
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 1
    is=0       

#ifdef TIMING
    call t_startf("pio_put_var_0d_real")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_0d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,1,MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_real_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real ... "
          endif
#endif
          !!! PnetCDF
          !ierr = nfmpi_put_vara_real_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
         ! ndims = 1
         ! ierr = cfio_put_vara_real(File%fh, varid, ndims,int(start),int(count), ival)

          !!! CFIO
          ival_to_arr(1) = ival
          ierr = cfio_put_vara_real(File%fh, varid, 0, start, count, ival_to_arr)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real over ", ierr
          endif
#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_0d_real")
#endif 
  end function put_var_0d_real

! TYPE int,real,double
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param File : A file handle returne from \ref PIO_openfile or \ref PIO_createfile.
!! @param varid : The netcdf variable identifier
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 858 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_0d_double (File,varid, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid
    real(r8), intent(in) :: ival
    integer :: iotype
    integer :: i, is, msg, mpierr, xlen
    type(iosystem_desc_t), pointer :: ios
    integer :: start(1),count(1), itype
    integer(4) :: ndims

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
    real(r8) :: ival_to_arr(1)
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

    ierr=PIO_NOERR

    iotype = File%iotype 
    start = 1
    count = 1
    is=0       

#ifdef TIMING
    call t_startf("pio_put_var_0d_double")
#endif 

    ios=>File%iosystem
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVAR_0d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then
       call MPI_BCAST(ival,1,MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if

    if(Ios%IOProc) then
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          if(Ios%io_rank>0) count=0
          ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
               int(count,kind=pio_offset),ival)
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          if(Ios%io_rank>0) count=0
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_double_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double ... "
          endif
#endif
          !!! PnetCDF
          !ierr = nfmpi_put_vara_double_all(File%fh, varid, int(start,kind=pio_offset),&
          !     int(count,kind=pio_offset),ival)
         ! ndims = 1
         ! ierr = cfio_put_vara_double(File%fh, varid, ndims,int(start),int(count), ival)

          !!! CFIO
          ival_to_arr(1) = ival
          ierr = cfio_put_vara_double(File%fh, varid, 0, start, count, ival_to_arr)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double over ", ierr
          endif
#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival)
       case(pio_iotype_netcdf,pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival)
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified" )

       end select
    end if

    call check_netcdf(File,ierr,__PIO_FILE__,__LINE__)
#ifdef TIMING
    call t_stopf("pio_put_var_0d_double")
#endif 
  end function put_var_0d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_0d_text (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    character(len=*), intent(in) :: ival
    integer :: iotype

    ierr = put_var_0d_text (File, vardesc%varid, ival)
  end function put_var_vdesc_0d_text

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_1d_text (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    character(len=*), intent(in) :: ival(:)
    integer :: iotype

    ierr = put_var_1d_text (File, vardesc%varid, ival)
  end function put_var_vdesc_1d_text

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_2d_text (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    character(len=*), intent(in) :: ival(:,:)
    integer :: iotype

    ierr = put_var_2d_text (File, vardesc%varid, ival)
  end function put_var_vdesc_2d_text

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_3d_text (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    character(len=*), intent(in) :: ival(:,:,:)
    integer :: iotype

    ierr = put_var_3d_text (File, vardesc%varid, ival)
  end function put_var_vdesc_3d_text

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_4d_text (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    character(len=*), intent(in) :: ival(:,:,:,:)
    integer :: iotype

    ierr = put_var_4d_text (File, vardesc%varid, ival)
  end function put_var_vdesc_4d_text

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_5d_text (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    character(len=*), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype

    ierr = put_var_5d_text (File, vardesc%varid, ival)
  end function put_var_vdesc_5d_text

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_0d_real (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r4), intent(in) :: ival
    integer :: iotype

    ierr = put_var_0d_real (File, vardesc%varid, ival)
  end function put_var_vdesc_0d_real

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_1d_real (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r4), intent(in) :: ival(:)
    integer :: iotype

    ierr = put_var_1d_real (File, vardesc%varid, ival)
  end function put_var_vdesc_1d_real

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_2d_real (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r4), intent(in) :: ival(:,:)
    integer :: iotype

    ierr = put_var_2d_real (File, vardesc%varid, ival)
  end function put_var_vdesc_2d_real

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_3d_real (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r4), intent(in) :: ival(:,:,:)
    integer :: iotype

    ierr = put_var_3d_real (File, vardesc%varid, ival)
  end function put_var_vdesc_3d_real

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_4d_real (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r4), intent(in) :: ival(:,:,:,:)
    integer :: iotype

    ierr = put_var_4d_real (File, vardesc%varid, ival)
  end function put_var_vdesc_4d_real

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_5d_real (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r4), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype

    ierr = put_var_5d_real (File, vardesc%varid, ival)
  end function put_var_vdesc_5d_real

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_0d_double (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r8), intent(in) :: ival
    integer :: iotype

    ierr = put_var_0d_double (File, vardesc%varid, ival)
  end function put_var_vdesc_0d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_1d_double (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r8), intent(in) :: ival(:)
    integer :: iotype

    ierr = put_var_1d_double (File, vardesc%varid, ival)
  end function put_var_vdesc_1d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_2d_double (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r8), intent(in) :: ival(:,:)
    integer :: iotype

    ierr = put_var_2d_double (File, vardesc%varid, ival)
  end function put_var_vdesc_2d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_3d_double (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r8), intent(in) :: ival(:,:,:)
    integer :: iotype

    ierr = put_var_3d_double (File, vardesc%varid, ival)
  end function put_var_vdesc_3d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_4d_double (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r8), intent(in) :: ival(:,:,:,:)
    integer :: iotype

    ierr = put_var_4d_double (File, vardesc%varid, ival)
  end function put_var_vdesc_4d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_5d_double (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    real(r8), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype

    ierr = put_var_5d_double (File, vardesc%varid, ival)
  end function put_var_vdesc_5d_double

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_0d_int (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    integer(i4), intent(in) :: ival
    integer :: iotype

    ierr = put_var_0d_int (File, vardesc%varid, ival)
  end function put_var_vdesc_0d_int

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_1d_int (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    integer(i4), intent(in) :: ival(:)
    integer :: iotype

    ierr = put_var_1d_int (File, vardesc%varid, ival)
  end function put_var_vdesc_1d_int

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_2d_int (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    integer(i4), intent(in) :: ival(:,:)
    integer :: iotype

    ierr = put_var_2d_int (File, vardesc%varid, ival)
  end function put_var_vdesc_2d_int

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_3d_int (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    integer(i4), intent(in) :: ival(:,:,:)
    integer :: iotype

    ierr = put_var_3d_int (File, vardesc%varid, ival)
  end function put_var_vdesc_3d_int

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_4d_int (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    integer(i4), intent(in) :: ival(:,:,:,:)
    integer :: iotype

    ierr = put_var_4d_int (File, vardesc%varid, ival)
  end function put_var_vdesc_4d_int

! DIMS 0,1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 973 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_var_vdesc_5d_int (File, vardesc, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t) , intent(in) :: vardesc
    integer(i4), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype

    ierr = put_var_5d_int (File, vardesc%varid, ival)
  end function put_var_vdesc_5d_int

! DIMS 1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 996 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_1d_text (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    character(len=*), intent(in) :: ival(:)
    integer :: iotype, i,  msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_1d_text")
#endif 
    ndims=0
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen = len(ival)
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if


    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (1 > 0)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)
       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_text (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
             ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
            print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text not&
             defined"
          endif
#endif
             ierr = nfmpi_put_vara_text (File%fh, varid,  pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text_all&
             not defined" 
          endif
#endif
          !   ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
          !        pcount, ival, clen, MPI_CHARACTER)
             !ierr = cfio_put_vara_text (File%fh, varid, ndims, int(pstart),int(pcount), ival)
             ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text_all over",ierr
          endif
#endif

#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_1d_text")
#endif 
  end function put_vara_1d_text

! DIMS 1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 996 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_2d_text (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    character(len=*), intent(in) :: ival(:,:)
    integer :: iotype, i,  msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_2d_text")
#endif 
    ndims=0
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen = len(ival)
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if


    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (2 > 0)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)
       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_text (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
             ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
            print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text not&
             defined"
          endif
#endif
             ierr = nfmpi_put_vara_text (File%fh, varid,  pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text_all&
             not defined" 
          endif
#endif
          !   ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
          !        pcount, ival, clen, MPI_CHARACTER)
             !ierr = cfio_put_vara_text (File%fh, varid, ndims, int(pstart),int(pcount), ival)
             ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text_all over",ierr
          endif
#endif

#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_2d_text")
#endif 
  end function put_vara_2d_text

! DIMS 1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 996 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_3d_text (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    character(len=*), intent(in) :: ival(:,:,:)
    integer :: iotype, i,  msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_3d_text")
#endif 
    ndims=0
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen = len(ival)
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if


    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (3 > 0)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)
       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_text (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
             ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
            print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text not&
             defined"
          endif
#endif
             ierr = nfmpi_put_vara_text (File%fh, varid,  pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text_all&
             not defined" 
          endif
#endif
          !   ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
          !        pcount, ival, clen, MPI_CHARACTER)
             !ierr = cfio_put_vara_text (File%fh, varid, ndims, int(pstart),int(pcount), ival)
             ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text_all over",ierr
          endif
#endif

#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_3d_text")
#endif 
  end function put_vara_3d_text

! DIMS 1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 996 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_4d_text (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    character(len=*), intent(in) :: ival(:,:,:,:)
    integer :: iotype, i,  msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_4d_text")
#endif 
    ndims=0
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen = len(ival)
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if


    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (4 > 0)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)
       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_text (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
             ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
            print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text not&
             defined"
          endif
#endif
             ierr = nfmpi_put_vara_text (File%fh, varid,  pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text_all&
             not defined" 
          endif
#endif
          !   ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
          !        pcount, ival, clen, MPI_CHARACTER)
             !ierr = cfio_put_vara_text (File%fh, varid, ndims, int(pstart),int(pcount), ival)
             ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text_all over",ierr
          endif
#endif

#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_4d_text")
#endif 
  end function put_vara_4d_text

! DIMS 1,2,3,4,5
! TYPE text
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 996 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_5d_text (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    character(len=*), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, i,  msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_5d_text")
#endif 
    ndims=0
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen = len(ival)
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if


    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = TYPETEXT
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (5 > 0)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
       call MPI_BCAST(xlen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_CHARACTER,ios%CompMaster, ios%my_comm , mpierr)
    end if



    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)
       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_text (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
             ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_CHARACTER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
            print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined"
          endif
#endif
          ierr = nfmpi_begin_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text not&
             defined"
          endif
#endif
             ierr = nfmpi_put_vara_text (File%fh, varid,  pstart, &
                  pcount, ival, clen, MPI_CHARACTER)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text over",ierr
          endif
#endif
          end if
          if(ierr==PIO_NOERR) then
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not&
             defined" 
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_text_all&
             not defined" 
          endif
#endif
          !   ierr = nfmpi_put_vara_text_all (File%fh, varid, pstart, &
          !        pcount, ival, clen, MPI_CHARACTER)
             !ierr = cfio_put_vara_text (File%fh, varid, ndims, int(pstart),int(pcount), ival)
             ierr = PIO_NOERR
#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_text_all over",ierr
          endif
#endif

#endif
#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_5d_text")
#endif 
  end function put_vara_5d_text
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_1d_int (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    integer(i4), intent(in) :: ival(:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_1d_int")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (1 > 0)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_int ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_int ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_INTEGER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int not defined"
          endif
#endif

             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_INTEGER)
          !ierr = cfio_put_vara_int (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_int (File%fh, varid, 1, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_1d_int")
#endif 
  end function put_vara_1d_int
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_2d_int (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    integer(i4), intent(in) :: ival(:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_2d_int")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (2 > 0)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_int ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_int ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_INTEGER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int not defined"
          endif
#endif

             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_INTEGER)
          !ierr = cfio_put_vara_int (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_int (File%fh, varid, 2, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_2d_int")
#endif 
  end function put_vara_2d_int
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_3d_int (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    integer(i4), intent(in) :: ival(:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_3d_int")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (3 > 0)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_int ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_int ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_INTEGER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int not defined"
          endif
#endif

             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_INTEGER)
          !ierr = cfio_put_vara_int (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_int (File%fh, varid, 3, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_3d_int")
#endif 
  end function put_vara_3d_int
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_4d_int (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    integer(i4), intent(in) :: ival(:,:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_4d_int")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (4 > 0)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_int ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_int ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_INTEGER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int not defined"
          endif
#endif

             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_INTEGER)
          !ierr = cfio_put_vara_int (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_int (File%fh, varid, 4, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_4d_int")
#endif 
  end function put_vara_4d_int
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_5d_int (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    integer(i4), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_5d_int")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 103
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (5 > 0)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_int ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_int ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_int ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_INTEGER)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int not defined"
          endif
#endif

             ierr = nfmpi_put_vara_int (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_INTEGER)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_int over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_int_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_INTEGER)
          !ierr = cfio_put_vara_int (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_int (File%fh, varid, 5, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_int over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_5d_int")
#endif 
  end function put_vara_5d_int
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_1d_real (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r4), intent(in) :: ival(:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_1d_real")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (1 > 0)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_real ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_real ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL4)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real not defined"
          endif
#endif

             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL4)
          !ierr = cfio_put_vara_real (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_real (File%fh, varid, 1, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_1d_real")
#endif 
  end function put_vara_1d_real
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_2d_real (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r4), intent(in) :: ival(:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_2d_real")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (2 > 0)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_real ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_real ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL4)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real not defined"
          endif
#endif

             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL4)
          !ierr = cfio_put_vara_real (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_real (File%fh, varid, 2, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_2d_real")
#endif 
  end function put_vara_2d_real
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_3d_real (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r4), intent(in) :: ival(:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_3d_real")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (3 > 0)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_real ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_real ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL4)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real not defined"
          endif
#endif

             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL4)
          !ierr = cfio_put_vara_real (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_real (File%fh, varid, 3, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_3d_real")
#endif 
  end function put_vara_3d_real
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_4d_real (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r4), intent(in) :: ival(:,:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_4d_real")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (4 > 0)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_real ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_real ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL4)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real not defined"
          endif
#endif

             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL4)
          !ierr = cfio_put_vara_real (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_real (File%fh, varid, 4, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_4d_real")
#endif 
  end function put_vara_4d_real
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_5d_real (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r4), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_5d_real")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 101
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (5 > 0)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL4,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_real ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_real ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_real ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL4)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real not defined"
          endif
#endif

             ierr = nfmpi_put_vara_real (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL4)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_real over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_real_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL4)
          !ierr = cfio_put_vara_real (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_real (File%fh, varid, 5, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_real over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_5d_real")
#endif 
  end function put_vara_5d_real
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_1d_double (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r8), intent(in) :: ival(:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(1), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_1d_double")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_1d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (1 > 0)
       do i=1,1
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_double ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_double ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_1d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL8)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double not defined"
          endif
#endif

             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL8)
          !ierr = cfio_put_vara_double (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_double (File%fh, varid, 1, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_1d_double")
#endif 
  end function put_vara_1d_double
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_2d_double (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r8), intent(in) :: ival(:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(2), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_2d_double")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_2d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (2 > 0)
       do i=1,2
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,2,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_double ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_double ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_2d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL8)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double not defined"
          endif
#endif

             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL8)
          !ierr = cfio_put_vara_double (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_double (File%fh, varid, 2, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_2d_double")
#endif 
  end function put_vara_2d_double
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_3d_double (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r8), intent(in) :: ival(:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(3), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_3d_double")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_3d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (3 > 0)
       do i=1,3
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,3,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_double ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_double ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_3d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL8)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double not defined"
          endif
#endif

             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL8)
          !ierr = cfio_put_vara_double (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_double (File%fh, varid, 3, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_3d_double")
#endif 
  end function put_vara_3d_double
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_4d_double (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r8), intent(in) :: ival(:,:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(4), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_4d_double")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_4d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (4 > 0)
       do i=1,4
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,4,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_double ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_double ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_4d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL8)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double not defined"
          endif
#endif

             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL8)
          !ierr = cfio_put_vara_double (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_double (File%fh, varid, 4, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_4d_double")
#endif 
  end function put_vara_4d_double
! TYPE int,real,double
! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf attribute to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param varid : The netcdf variable identifier
!! @param start :
!! @param count :
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1212 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_5d_double (File,varid, start, count, ival) result(ierr)
    use nf_mod, only : pio_inq_varndims
    type (File_desc_t), intent(inout) :: File
    integer, intent(in) :: varid, start(:), count(:)

    integer(kind=PIO_OFFSET), allocatable :: pstart(:), pcount(:)

    real(r8), intent(in) :: ival(:,:,:,:,:)
    integer :: iotype, i, msg, mpierr
    integer(kind=pio_offset) :: clen
    type(iosystem_desc_t), pointer :: ios
    integer :: dims(5), xlen, itype, slen
    integer(4) :: ndims
#ifdef TIMING
    call t_startf("pio_put_vara_5d_double")
#endif 
    ierr=0
    iotype = File%iotype 
    ios=>File%iosystem
    xlen=1
    if(.not. ios%async_interface .or. .not. ios%ioproc ) then
       ierr = pio_inq_varndims(File, varid, ndims)
    end if
    if(ios%async_interface .and. .not. ios%ioproc ) then
       msg=PIO_MSG_PUTVARA_5d
       if(ios%comp_rank==0) call mpi_send(msg, 1, mpi_integer, ios%ioroot, 1, ios%union_comm, ierr)
       call MPI_BCAST(file%fh,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(varid,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       itype = 102
       call MPI_BCAST(itype,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       slen = size(start)
       call MPI_BCAST(slen,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(start,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(count,slen,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)

#if (5 > 0)
       do i=1,5
          dims(i)=size(ival,i)
       end do
       call MPI_BCAST(dims,5,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
#endif
    endif

    if(ios%async_interface ) then    
       call MPI_BCAST(ndims,1,MPI_INTEGER,ios%CompMaster, ios%my_comm , mpierr)
       call MPI_BCAST(ival,xlen*size(ival),MPI_REAL8,ios%CompMaster, ios%my_comm , mpierr)
    end if


    
    if(Ios%IOProc) then
       allocate(pstart(ndims),pcount(ndims))
       if(Ios%io_rank==0) then
          pstart = start(1:ndims)
          pcount = count(1:ndims)

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_double ndims start count ..." 
          do i = 1, ndims
             print *, __FILE__,__LINE__,start(i),count(i)
          end do
          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

       else
          pstart=1 ! avoids an unessasary pnetcdf error 
          pcount=0

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_double ndims start count ..." 
!          print *,__FILE__,__LINE__,"funk"
!          print *,__FILE__,__LINE__,"[CFIO DEBUG]: put_vara_5d_double ndims start count over" 
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc
       endif
       select case (iotype) 
#ifdef _PNETCDF
       case(pio_iotype_pnetcdf)
          clen=count(1)
          do i=2,size(count)
             clen=clen*count(i)
          end do
#ifdef USE_INDEP_WRITE
          ierr = nfmpi_begin_indep_data(File%fh)
          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then
             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)
          end if
          if(ierr==PIO_NOERR) then
             ierr = nfmpi_end_indep_data(File%fh)
          end if
#else
          ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
               pcount, ival, clen, MPI_REAL8)

#endif
#endif

!>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> zc
#ifdef _CFIO
       case(pio_iotype_cfio)

           clen=count(1)
           do i=2,size(count)
               clen=clen*count(i)
           end do
#ifdef USE_INDEP_WRITE

#ifdef CFIO_DEBUG
       !    open(unit = 1024, status = 'unknown', access = 'append', file = CFIO_PIO_LOG)
       !    write(1024,*) __FILE__, __LINE__, "nfmpi_put_vara_all - not defined in CFIO!"
       !    close(1024)
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_begin_indep_data not&
             defined" 
          endif
#endif

          ierr = nfmpi_begin_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_begin_indep_data over",ierr
          endif
#endif

          if(Ios%io_rank==0 .and. (ierr==NF_EINDEP .or. ierr==PIO_NOERR)) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double not defined"
          endif
#endif

             ierr = nfmpi_put_vara_double (File%fh, varid, pstart, &
                  pcount, ival, clen, MPI_REAL8)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_put_vara_double over",ierr
          endif
#endif
          end if

          if(ierr==PIO_NOERR) then

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_end_indep_data not defined"
          endif
#endif
             ierr = nfmpi_end_indep_data(File%fh)

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: nfmpi_end_indep_data over",ierr
          endif
#endif
          end if
#else
#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double ..."
          endif
#endif

          !!! PnetCDF
          !ierr = nfmpi_put_vara_double_all (File%fh, varid, pstart, &
          !     pcount, ival, clen, MPI_REAL8)
          !ierr = cfio_put_vara_double (File%fh, varid, ndims, int(pstart), int(pcount), ival)

          !!! CFIO
          ierr = cfio_put_vara_double (File%fh, varid, 5, int(pstart), int(pcount), ival)
          !ierr = PIO_NOERR

#ifdef CFIO_DEBUG
          if (File%iosystem%io_rank == 0) then
             print *,__FILE__,__LINE__,"[CFIO DEBUG]: cfio_put_vara_double over ",ierr
          endif
#endif

#endif

#endif
!<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< zc

#ifdef _NETCDF
       case(pio_iotype_netcdf4p)
          ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
       case(pio_iotype_netcdf, pio_iotype_netcdf4c)
          ! Only io proc 0 will do writing
          if (Ios%io_rank == 0) then
             ierr = nf90_put_var(File%fh, varid, ival, start=int(pstart), count=int(pcount))
          end if
#endif
       case default
          print *,__PIO_FILE__,__LINE__,iotype
          call piodie(__PIO_FILE__,__LINE__,"bad iotype specified")
       end select
       deallocate(pstart, pcount)
    end if
    call check_netcdf(File, ierr,__PIO_FILE__,__LINE__)

#ifdef TIMING
    call t_stopf("pio_put_vara_5d_double")
#endif 
  end function put_vara_5d_double

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_1d_text (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    character(len=*), intent(in) :: ival(:)

    ierr = put_vara_1d_text (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_1d_text

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_2d_text (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    character(len=*), intent(in) :: ival(:,:)

    ierr = put_vara_2d_text (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_2d_text

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_3d_text (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    character(len=*), intent(in) :: ival(:,:,:)

    ierr = put_vara_3d_text (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_3d_text

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_4d_text (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    character(len=*), intent(in) :: ival(:,:,:,:)

    ierr = put_vara_4d_text (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_4d_text

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_5d_text (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    character(len=*), intent(in) :: ival(:,:,:,:,:)

    ierr = put_vara_5d_text (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_5d_text

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_1d_real (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r4), intent(in) :: ival(:)

    ierr = put_vara_1d_real (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_1d_real

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_2d_real (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r4), intent(in) :: ival(:,:)

    ierr = put_vara_2d_real (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_2d_real

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_3d_real (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r4), intent(in) :: ival(:,:,:)

    ierr = put_vara_3d_real (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_3d_real

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_4d_real (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r4), intent(in) :: ival(:,:,:,:)

    ierr = put_vara_4d_real (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_4d_real

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_5d_real (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r4), intent(in) :: ival(:,:,:,:,:)

    ierr = put_vara_5d_real (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_5d_real

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_1d_double (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r8), intent(in) :: ival(:)

    ierr = put_vara_1d_double (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_1d_double

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_2d_double (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r8), intent(in) :: ival(:,:)

    ierr = put_vara_2d_double (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_2d_double

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_3d_double (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r8), intent(in) :: ival(:,:,:)

    ierr = put_vara_3d_double (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_3d_double

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_4d_double (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r8), intent(in) :: ival(:,:,:,:)

    ierr = put_vara_4d_double (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_4d_double

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_5d_double (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    real(r8), intent(in) :: ival(:,:,:,:,:)

    ierr = put_vara_5d_double (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_5d_double

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_1d_int (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    integer(i4), intent(in) :: ival(:)

    ierr = put_vara_1d_int (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_1d_int

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_2d_int (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    integer(i4), intent(in) :: ival(:,:)

    ierr = put_vara_2d_int (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_2d_int

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_3d_int (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    integer(i4), intent(in) :: ival(:,:,:)

    ierr = put_vara_3d_int (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_3d_int

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_4d_int (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    integer(i4), intent(in) :: ival(:,:,:,:)

    ierr = put_vara_4d_int (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_4d_int

! DIMS 1,2,3,4,5
!>
!! @public
!! @ingroup PIO_put_var
!! @brief Writes an netcdf variable to a file
!! @details
!! @param File @copydoc file_desc_t
!! @param vardesc @copydoc var_desc_t
!! @param start : 
!! @param count : 
!! @param ival : The value for the netcdf metadata
!! @retval ierr @copydoc error_return
!<
# 1432 "/home/export/online1/qhtest/swqh/USER-TSINGHUA/wwj/cesm0920/models/utils/pio/pionfput_mod.F90.in"
  integer function put_vara_vdesc_5d_int (File,vardesc, start, count, ival) result(ierr)
    type (File_desc_t), intent(inout) :: File
    type(var_desc_t), intent(in) :: vardesc
    integer, intent(in) ::  start(:), count(:)
    integer(i4), intent(in) :: ival(:,:,:,:,:)

    ierr = put_vara_5d_int (File, vardesc%varid, start, count, ival)


  end function put_vara_vdesc_5d_int
end module pionfput_mod
